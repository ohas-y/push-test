<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>体調記録システム 登録ページ</title>
  <style>
    /* 共通ボックスデザイン */
    .terms-box {
      border: 1px solid #ccc;
      background-color: #f9f9f9;
      padding: 20px;
      border-radius: 8px;
      width: 80%;
      margin: 20px auto;
    }

    h2 {
      margin-top: 0;
      border-bottom: 1px solid #ddd;
      padding-bottom: 5px;
    }

    p {
      line-height: 1.8;
    }

    #agreeButton, #registerButton {
      padding: 10px 20px;
      font-size: 14px;
      margin-top: 20px;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
  </style>
</head>
<body>
  <h1>体調記録システム 登録</h1>

  <p>以下の文章をお読みいただき、同意いただけましたらメールアドレスを登録してください。</p> 

  <!-- 利用規約 -->
  <section class="terms-box">
    <h2>利用規約</h2>
    <p>
      第1条（サービス内容）<br>
      本サービスは、利用者が毎日の体調データを記録し、管理するためのBOTサービスです。<br><br>

      第2条（アカウント利用）<br>
      登録されたアカウントは、利用者自身の記録管理のみに使用します。
      これ以外の目的（広告配信、第三者提供など）には使用しません。<br><br>

      第3条（禁止事項）<br>
      以下の行為を禁止します。<br>
      - 不正アクセスや他の利用者への迷惑行為<br>
      - 本サービスの運営を妨げる行為<br><br>

      第4条（免責事項）<br>
      本サービスの利用によって生じたいかなる損害についても、当方は責任を負いません。
      記録内容の正確性や健康上の判断は、利用者ご自身の責任で行ってください。<br><br>

      第5条（規約変更）<br>
      本規約は必要に応じて変更される場合があります。変更後の規約は公開時点から効力を持ちます。
    </p>
 </section>

    <!-- プライバシーポリシー -->
  <section class="terms-box">
    <h2>プライバシーポリシー</h2>
    <p>
      第1条（収集する情報）<br>
      - 利用者が入力した体調や気分の記録<br>
      - アカウント情報（メールアドレス等）<br><br>

      第2条（利用目的）<br>
      収集した情報は、利用者自身の体調管理をサポートする目的でのみ使用します。<br><br>

      第3条（第三者提供）<br>
      収集した情報は、法令に基づく場合を除き、第三者に提供することはありません。<br><br>

      第4条（情報管理）<br>
      個人情報および記録データは、安全に管理します。<br><br>

      第5条（利用者の権利）<br>
      利用者は、自身の登録情報の確認・修正・削除をいつでも行うことができます。
    </p>
  </section>
    
    <button id="agreeButton">同意して登録へ</button>

 <!-- メール登録 -->
<section id="register" style="display:none;">
  <h2>メールアドレス登録</h2>
  <p>※Gmail以外のメールアドレスは登録できません。</p> 
  <input type="email" id="email" placeholder="メールアドレスを入力" required
         style="width: 100%; padding: 10px; font-size: 16px; box-sizing: border-box;">
  <button id="registerButton">登録する</button>
</section>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbwoW4r6fgR9rr0sNBBU12Lk4giULB-OqrdUqDzI91SKCMAOx9nFTDFeZRFGLhTD90sI/exec";

    // 利用規約同意 → メール登録表示
    document.getElementById('agreeButton').addEventListener('click', () => {
      document.querySelectorAll('.terms-box').forEach(box => box.style.display = 'none');
      document.getElementById('agreeButton').style.display = 'none';
      document.getElementById('register').style.display = 'block';
    });

    // メール登録
    document.getElementById('registerButton').addEventListener('click', async () => {
      const email = document.getElementById('email').value.trim();
      if (!email) { alert('メールを入力してください'); return; }
 
      // Gmailチェック（フロント側）
      if (!email.endsWith("@gmail.com")) {
        alert("Gmail以外は登録できません");
        return;
      }

      // GASに登録
      try {
        const response = await fetch(GAS_URL, {
          method: 'POST',
          mode: 'cors',
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email })
        });

        const result = await response.json();
        if (result.result === "success") {
          alert('登録完了！1日3回メールが届きます');
          document.getElementById('register').style.display = 'none';
        } else {
          alert('登録エラー: ' + result.message);
        }
      } catch (e) {
        alert('通信エラー: ' + e.message);
      }
    });
  </script>
</body>
</html>
